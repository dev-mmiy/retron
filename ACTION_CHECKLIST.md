# 動作確認チェックリスト

## 前提条件確認
- [x] kernel-ram.sysがビルド済み（288KB）
- [x] エントリーポイント: 0x40200000
- [x] QEMUがインストール済み
- [ ] GDBがインストール済み（必要に応じて）

## 動作確認手順

### 1. QEMUを起動（GDBサーバー有効）
```bash
cd /home/miyasaka/source/retron
./run-tkernel-qemu.sh
```

### 2. GDBで接続（別ターミナル）
```bash
cd /home/miyasaka/source/retron
./debug-kernel.sh
```

### 3. 確認ポイント

#### 3.1 エントリーポイント
- [ ] `start`で停止するか確認
- [ ] PCレジスタが0x40200000になっているか確認

#### 3.2 初期化シーケンス
- [ ] `main`が呼ばれるか確認
- [ ] `init_system`が呼ばれるか確認
- [ ] `init_device`が呼ばれるか確認
- [ ] `uart_pl011_init`が呼ばれるか確認

#### 3.3 UART出力
- [ ] `uart_pl011_putchar`が呼ばれるか確認
- [ ] QEMUのシリアル出力に文字が表示されるか確認

#### 3.4 カーネル起動
- [ ] `t_kernel_main`が呼ばれるか確認
- [ ] `init_task`が呼ばれるか確認
- [ ] `usermain`が呼ばれるか確認

## 期待される出力

正常に動作している場合、以下のような出力が期待されます：

```
T-Kernel 2.0 (ReTron OS ARM AArch64)
...
```

または、UART初期化が成功している場合、何らかの文字列が表示されるはずです。

## トラブルシューティング

### QEMUが起動しない
- QEMUのバージョンを確認
- メモリサイズを調整（-m 128Mなど）

### GDBが接続できない
- QEMUが`-s -S`オプションで起動されているか確認
- ポート1234が使用可能か確認

### ブレークポイントで停止しない
- シンボルが正しくロードされているか確認
- アドレスが正しいか確認

### UARTから出力されない
- UARTレジスタの状態を確認
- `uart_pl011_init`が呼ばれているか確認
- UARTのCRレジスタ（0x09000030）が有効になっているか確認

## 次のステップ

動作確認ができたら：
1. UART出力が表示されることを確認
2. カーネルの初期化シーケンスが正常に動作することを確認
3. 必要に応じて、残りの実装項目（レジスタ取得/設定など）を実装
